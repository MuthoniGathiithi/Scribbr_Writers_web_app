<!-- Assignments Page Header -->
<div class="position-relative py-5 mb-5">
  <!-- Background with gradient overlay -->
  <div class="hero-bg-image"></div>
  
  <div class="container position-relative">
    <div class="row">
      <div class="col-md-8 mx-auto text-center">
        <h1 class="display-4 fw-bold">Available <span class="text-gradient">Assignments</span></h1>
        <p class="lead">Browse our current writing and translation tasks</p>
      </div>
    </div>
  </div>
</div>

<div class="row">
  <div class="col-md-3 mb-4">
    <% if (locals.user) { %>
    <div class="card border-0 shadow-sm rounded-xl">
      <div class="card-body text-center p-4 p-lg-5">
        <div class="mb-4">
          <img src="https://via.placeholder.com/100x100" alt="Profile" class="rounded-circle border-3 border-primary">
        </div>
        <h5 class="card-title"><%= user.name %></h5>
        <p class="card-text text-muted"><%= user.email %></p>
        <div class="d-grid gap-2">
          <a href="/users/profile" class="btn btn-outline-primary shadow-hover">Edit Profile</a>
        </div>
      </div>
    </div>
    <% } else { %>
    <!-- Guest User Notice -->
    <div class="card border-0 shadow-sm rounded-xl">
      <div class="card-body text-center p-4 p-lg-5">
        <div class="mb-4">
          <i class="fas fa-user-circle fa-4x text-gradient"></i>
        </div>
        <h5 class="card-title">Guest User</h5>
        <p class="card-text">Register to access full assignment details and accept tasks.</p>
        <div class="d-grid gap-2">
          <a href="/users/register" class="btn btn-primary shadow-hover">Register Now</a>
          <a href="/users/login" class="btn btn-outline-primary">Login</a>
        </div>
      </div>
    </div>
    <% } %>
    
    <div class="card border-0 shadow-sm rounded-xl mt-4">
      <div class="card-header bg-white">
        <h5 class="mb-0"><i class="fas fa-link text-primary me-2"></i>Quick Links</h5>
      </div>
      <div class="list-group list-group-flush">
        <a href="/dashboard" class="list-group-item list-group-item-action">
          <i class="fas fa-tachometer-alt me-2"></i> Dashboard
        </a>
        <a href="/dashboard/training" class="list-group-item list-group-item-action">
          <i class="fas fa-graduation-cap me-2"></i> Training
        </a>
        <a href="/payments" class="list-group-item list-group-item-action">
          <i class="fas fa-credit-card me-2"></i> Payment
        </a>
        <a href="/dashboard/assignments" class="list-group-item list-group-item-action active">
          <i class="fas fa-tasks me-2"></i> Assignments
        </a>
      </div>
    </div>
  </div>
  
  <div class="col-md-9">
    <!-- Translation Languages Filter -->
    <div class="card border-0 shadow-sm rounded-xl mb-4">
      <div class="card-header bg-white">
        <h5 class="mb-0"><i class="fas fa-language text-primary me-2"></i>Available Translation Languages</h5>
      </div>
      <div class="card-body">
        <div class="row g-2">
          <div class="col-6 col-md-3">
            <div class="form-check">
              <input class="form-check-input" type="checkbox" value="english" id="englishCheck" checked>
              <label class="form-check-label" for="englishCheck">ENGLISH</label>
            </div>
          </div>
          <div class="col-6 col-md-3">
            <div class="form-check">
              <input class="form-check-input" type="checkbox" value="dutch" id="dutchCheck">
              <label class="form-check-label" for="dutchCheck">DUTCH</label>
            </div>
          </div>
          <div class="col-6 col-md-3">
            <div class="form-check">
              <input class="form-check-input" type="checkbox" value="german" id="germanCheck">
              <label class="form-check-label" for="germanCheck">GERMAN</label>
            </div>
          </div>
          <div class="col-6 col-md-3">
            <div class="form-check">
              <input class="form-check-input" type="checkbox" value="arabic" id="arabicCheck">
              <label class="form-check-label" for="arabicCheck">ARABIC</label>
            </div>
          </div>
          <div class="col-6 col-md-3">
            <div class="form-check">
              <input class="form-check-input" type="checkbox" value="french" id="frenchCheck">
              <label class="form-check-label" for="frenchCheck">FRENCH</label>
            </div>
          </div>
          <div class="col-6 col-md-3">
            <div class="form-check">
              <input class="form-check-input" type="checkbox" value="italian" id="italianCheck">
              <label class="form-check-label" for="italianCheck">ITALIAN</label>
            </div>
          </div>
          <div class="col-6 col-md-3">
            <div class="form-check">
              <input class="form-check-input" type="checkbox" value="swahili" id="swahiliCheck">
              <label class="form-check-label" for="swahiliCheck">SWAHILI</label>
            </div>
          </div>
          <div class="col-6 col-md-3">
            <div class="form-check">
              <input class="form-check-input" type="checkbox" value="chinese" id="chineseCheck">
              <label class="form-check-label" for="chineseCheck">CHINESE</label>
            </div>
          </div>
        </div>
        <div class="d-flex justify-content-end mt-3">
          <button class="btn btn-primary shadow-hover" id="applyFilters"><i class="fas fa-filter me-2"></i>Apply Filters</button>
        </div>
      </div>
    </div>
    
    <div class="card border-0 shadow-sm rounded-xl mb-4">
      <div class="card-header bg-white d-flex justify-content-between align-items-center">
        <h5 class="mb-0"><i class="fas fa-clipboard-list text-primary me-2"></i>Available Assignments</h5>
        <div class="dropdown">
          <button class="btn btn-outline-primary dropdown-toggle" type="button" id="filterDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            <i class="fas fa-filter me-1"></i> Filter by Type
          </button>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="filterDropdown">
            <li><a class="dropdown-item" href="javascript:void(0);">All Categories</a></li>
            <li><hr class="dropdown-divider"></li>
            <li><a class="dropdown-item" href="/services/blog-writing">Blog Writing</a></li>
            <li><a class="dropdown-item" href="/services/content-creation">Content Creation</a></li>
            <li><a class="dropdown-item" href="/services/product-descriptions">Product Descriptions</a></li>
            <li><a class="dropdown-item" href="/services/email-newsletters">Email Newsletters</a></li>
          </ul>
        </div>
      </div>
      <div class="card-body">
        <div class="row">
          <% assignments.forEach(assignment => { %>
            <div class="col-md-6 mb-4">
              <div class="card h-100 border-0 shadow-sm">
                <div class="card-body">
                  <div class="d-flex justify-content-between align-items-start mb-3">
                    <h5 class="card-title"><%= assignment.title %></h5>
                    <span class="badge bg-success">Available</span>
                  </div>
                  <p class="card-text"><%= assignment.description %></p>
                  <div class="d-flex justify-content-between align-items-center mt-3">
                    <small class="text-muted">
                      <i class="fas fa-clock me-1"></i> Deadline: <%= new Date(assignment.deadline).toLocaleDateString() %>
                    </small>
                    <button type="button" class="btn btn-sm btn-primary" data-bs-toggle="modal" data-bs-target="#assignmentModal<%= assignment.id %>">
                      View Details
                    </button>
                  </div>
                </div>
              </div>
            </div>
            
            <!-- Assignment Modal -->
            <div class="modal fade" id="assignmentModal<%= assignment.id %>" tabindex="-1" aria-labelledby="assignmentModalLabel<%= assignment.id %>" aria-hidden="true">
              <div class="modal-dialog modal-lg">
                <div class="modal-content">
                  <div class="modal-header">
                    <h5 class="modal-title" id="assignmentModalLabel<%= assignment.id %>"><%= assignment.title %></h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                  </div>
                  <div class="modal-body">
                    <% if (locals.user) { %>
                    <!-- Full details for registered users -->
                    <div class="mb-4">
                      <h6>Description</h6>
                      <p><%= assignment.description %></p>
                    </div>
                    
                    <div class="row mb-4">
                      <div class="col-md-6">
                        <h6>Deadline</h6>
                        <p><i class="fas fa-calendar-alt me-2"></i><%= new Date(assignment.deadline).toLocaleDateString() %></p>
                      </div>
                      <div class="col-md-6">
                        <h6>Status</h6>
                        <p><span class="badge bg-success">Available</span></p>
                      </div>
                    </div>
                    
                    <div class="mb-4">
                      <h6>Requirements</h6>
                      <ul class="list-group list-group-flush">
                        <li class="list-group-item bg-transparent px-0">
                          <i class="fas fa-check-circle text-success me-2"></i> Follow our writing standards
                        </li>
                        <li class="list-group-item bg-transparent px-0">
                          <i class="fas fa-check-circle text-success me-2"></i> Include relevant keywords
                        </li>
                        <li class="list-group-item bg-transparent px-0">
                          <i class="fas fa-check-circle text-success me-2"></i> Proofread thoroughly before submission
                        </li>
                        <li class="list-group-item bg-transparent px-0">
                          <i class="fas fa-check-circle text-success me-2"></i> Submit by the deadline
                        </li>
                      </ul>
                    </div>
                    
                    <div class="alert alert-info">
                      <p class="mb-0">
                        <i class="fas fa-info-circle me-2"></i>
                        Once you accept this assignment, you will have until the deadline to complete it. Make sure you can commit to this timeline before accepting.
                      </p>
                    </div>
                    <% } else { %>
                    <!-- Limited preview for non-registered users -->
                    <div class="mb-4">
                      <h6>Description Preview</h6>
                      <p><%= assignment.description.substring(0, 100) %>... <span class="text-muted">[Full description available after registration]</span></p>
                    </div>
                    
                    <div class="row mb-4">
                      <div class="col-md-6">
                        <h6>Deadline</h6>
                        <p><i class="fas fa-calendar-alt me-2"></i><%= new Date(assignment.deadline).toLocaleDateString() %></p>
                      </div>
                      <div class="col-md-6">
                        <h6>Status</h6>
                        <p><span class="badge bg-success">Available</span></p>
                      </div>
                    </div>
                    
                    <div class="alert alert-primary border-0 shadow-sm rounded-xl">
                      <div class="text-center py-4">
                        <i class="fas fa-lock fa-3x mb-3 text-gradient"></i>
                        <h5>Registration Required</h5>
                        <p>To view full assignment details and accept tasks, please register an account.</p>
                        <p><strong>Registration Fee:</strong> KES 450 via M-Pesa</p>
                        <div class="mt-3">
                          <a href="/users/register" class="btn btn-primary shadow-hover">Register Now</a>
                        </div>
                      </div>
                    </div>
                    <% } %>
                  </div>
                  <div class="modal-footer">
                    <button type="button" class="btn btn-outline-primary" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary shadow-hover">Accept Assignment</button>
                  </div>
                </div>
              </div>
            </div>
          <% }); %>
        </div>
      </div>
    </div>
    
    <div class="card border-0 shadow-sm rounded-xl">
      <div class="card-header bg-white">
        <h5 class="mb-0"><i class="fas fa-tasks text-primary me-2"></i>My Assignments</h5>
      </div>
      <div class="card-body text-center py-5">
        <i class="fas fa-clipboard-list fa-4x text-gradient mb-4"></i>
        <h5>No Active Assignments</h5>
        <p class="text-muted">You don't have any active assignments yet. Accept an assignment from the available list to get started.</p>
      </div>
    </div>
  </div>
</div>
